<div class="h-[80vh] max-w-6xl mx-auto bg-[var(--background)]/95 backdrop-blur-xl rounded-2xl shadow-2xl flex overflow-hidden border border-[var(--border)]">
  <!-- Left Sidebar -->
  <div class="w-1/3 border-r border-[var(--border)] flex flex-col">
    <!-- Search -->
    <div class="p-3 border-b border-[var(--border)] bg-[var(--muted)]/50">
      <input
        [(ngModel)]="conversationSearch"
        type="text"
        placeholder="Search conversations..."
        class="w-full px-3 py-2 rounded-xl border border-[var(--border)] bg-[var(--background)] text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-[var(--primary)]"
      />
    </div>

    <!-- Conversation List -->
    <div class="flex-1 overflow-y-auto">
      <div
        *ngFor="let c of filteredConversations"
        (click)="selectConversation(c)"
        class="flex items-center justify-between p-3 cursor-pointer hover:bg-[var(--muted)]/60 transition-colors duration-200"
        [ngClass]="{ 'bg-[var(--muted)]/70': selectedConversation?.id === c.id }"
      >
        <div class="flex items-center gap-3">
          <!-- Avatar -->
          <div class="w-10 h-10 rounded-full bg-[var(--primary)] flex items-center justify-center text-white font-bold shadow">
            {{ c.name.charAt(0) }}
          </div>
          <!-- Info -->
          <div class="min-w-0">
            <p class="font-semibold text-[var(--foreground)] truncate flex items-center gap-1">
              {{ c.name }}
              <span class="ml-1 text-[10px] px-2 py-0.5 rounded-full bg-[var(--primary)]/20 text-[var(--primary)]" *ngIf="c.userType">
                {{ c.userType }}
              </span>
            </p>
            <p class="text-xs text-[var(--muted-foreground)] truncate max-w-[160px]">{{ c.lastMessage }}</p>
          </div>
        </div>
        <!-- Right side: Time & Unread -->
        <div class="flex flex-col items-end shrink-0">
          <span class="text-xs text-[var(--muted-foreground)]">{{ c.time }}</span>
          <span
            *ngIf="c.unreadCount > 0"
            class="mt-1 bg-[var(--primary)] text-[var(--primary-foreground)] rounded-full text-[10px] px-2 py-0.5 shadow-sm"
          >
            {{ c.unreadCount }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Right Chat Panel -->
  <div class="flex-1 flex flex-col">
    <!-- Chat Header -->
    <div class="p-4 border-b border-[var(--border)] flex items-center gap-3 bg-[var(--muted)]/50">
      <div
        *ngIf="selectedConversation"
        class="w-10 h-10 rounded-full bg-[var(--primary)] flex items-center justify-center text-white font-bold shadow"
      >
        {{ selectedConversation.name.charAt(0) }}
      </div>
      <div>
        <p class="font-semibold text-[var(--foreground)]">{{ selectedConversation?.name || 'Select a conversation' }}</p>
        <p class="text-xs text-[var(--muted-foreground)]">{{ selectedConversation?.userType }}</p>
      </div>
    </div>

    <!-- Messages -->
    <div class="flex-1 overflow-y-auto p-4 space-y-3 bg-[var(--background)]">
      <div
        *ngFor="let msg of selectedConversation?.messages"
        class="flex"
        [ngClass]="{
          'justify-end': msg.senderType === 'Admin',
          'justify-start': msg.senderType !== 'Admin'
        }"
      >
        <div
          class="max-w-[70%] px-4 py-2 rounded-2xl shadow-sm"
          [ngClass]="{
            'bg-[var(--primary)] text-[var(--primary-foreground)] rounded-br-sm': msg.senderType === 'Admin',
            'bg-[var(--muted)] text-[var(--foreground)] rounded-bl-sm': msg.senderType !== 'Admin'
          }"
        >
          <p class="text-sm leading-snug">{{ msg.text }}</p>
          <span class="block text-[10px] opacity-70 mt-1 text-right">{{ msg.time }}</span>
        </div>
      </div>
    </div>

    <!-- Input -->
    <div class="p-3 border-t border-[var(--border)] flex gap-2 bg-[var(--muted)]/50">
      <input
        [(ngModel)]="newMessage"
        type="text"
        placeholder="Type a message..."
        class="flex-1 px-3 py-2 rounded-xl border border-[var(--border)] bg-[var(--background)] text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-[var(--primary)]"
        (keyup.enter)="sendMessage()"
      />
      <button
        (click)="sendMessage()"
        class="bg-[var(--primary)] text-[var(--primary-foreground)] px-4 py-2 rounded-xl hover:opacity-90 shadow-md transition"
      >
        <i class="fas fa-paper-plane"></i>
      </button>
    </div>
  </div>
</div>
