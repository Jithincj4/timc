<div class="mx-auto w-full max-w-md">
  <!-- Progress Indicator -->
  <form [formGroup]="signUpForm" (ngSubmit)="onSubmit()" class="bg-card rounded-xl p-4 shadow-lg sm:rounded-2xl sm:p-6">
    <div class="mx-auto w-full max-w-md">
      <!-- Progress Indicator -->
      <div class="mb-6 sm:mb-8">
        <div class="mb-2 flex items-center justify-between">
          <div *ngFor="let step of steps; let i = index" class="flex items-center">
            <div
              class="flex h-6 w-6 items-center justify-center rounded-full text-xs font-medium sm:h-8 sm:w-8"
              [ngClass]="currentStep >= i ? 'bg-primary text-primary-foreground' : 'bg-muted text-muted-foreground'">
              {{ i + 1 }}
            </div>
            <div
              *ngIf="i < steps.length - 1"
              class="mx-1 h-1 w-8 sm:w-12"
              [ngClass]="currentStep > i ? 'bg-primary' : 'bg-muted'"></div>
          </div>
        </div>
        <div class="text-muted-foreground text-center text-xs sm:text-sm">
          {{ 'signup.steps.' + currentStep + '.title' | translate }}
        </div>
      </div>

      <form
        [formGroup]="signUpForm"
        (ngSubmit)="onSubmit()"
        class="bg-card rounded-xl p-4 shadow-lg sm:rounded-2xl sm:p-6">
        <!-- Step 1: Personal Info -->
        <div *ngIf="currentStep === 0" class="animate-fade-in space-y-4 sm:space-y-5">
          <div class="mb-4 text-center sm:mb-6">
            <h2 class="text-primary text-xl font-bold sm:text-2xl">{{ 'signup.personal.heading' | translate }}</h2>
            <p class="text-muted-foreground mt-1 text-sm">{{ 'signup.personal.subheading' | translate }}</p>
          </div>

          <div>
            <label class="text-foreground mb-1.5 block text-sm font-medium">
              {{ 'signup.personal.fullName' | translate }}
            </label>
            <input type="text" formControlName="fullName" placeholder="John Doe" class="input" />
          </div>

          <div>
            <label class="text-foreground mb-1.5 block text-sm font-medium">
              {{ 'signup.personal.dob' | translate }}
            </label>
            <input type="date" formControlName="dateOfBirth" class="input" />
          </div>

          <div>
            <label class="text-foreground mb-1.5 block text-sm font-medium">
              {{ 'signup.personal.email' | translate }}
            </label>
            <input type="email" formControlName="email" placeholder="you@example.com" class="input" />
          </div>

          <div>
            <label class="text-foreground mb-1.5 block text-sm font-medium">
              {{ 'signup.personal.password' | translate }}
            </label>
            <div class="relative">
              <input
                [type]="showPassword ? 'text' : 'password'"
                formControlName="password"
                [placeholder]="'signup.personal.passwordPlaceholder' | translate"
                class="input" />
              <button type="button" (click)="togglePassword()" class="password-toggle">
                <svg-icon
                  [src]="
                    showPassword
                      ? 'assets/icons/heroicons/outline/eye.svg'
                      : 'assets/icons/heroicons/outline/eye-off.svg'
                  "></svg-icon>
              </button>
            </div>
          </div>
        </div>

        <!-- Step 2: Identification -->
        <div *ngIf="currentStep === 1" class="animate-fade-in space-y-4 sm:space-y-5">
          <div class="mb-4 text-center sm:mb-6">
            <h2 class="text-primary text-xl font-bold sm:text-2xl">
              {{ 'signup.identification.heading' | translate }}
            </h2>
            <p class="text-muted-foreground mt-1 text-sm">{{ 'signup.identification.subheading' | translate }}</p>
          </div>

          <div class="grid grid-cols-2 gap-2 sm:gap-3">
            <label
              *ngFor="let idType of idTypes"
              class="cursor-pointer rounded-lg border px-3 py-2 text-center text-sm transition-all duration-150"
              [ngClass]="
                signUpForm.get('identificationType')?.value === idType.value
                  ? 'bg-primary text-primary-foreground border-primary shadow'
                  : 'bg-muted text-muted-foreground border-border hover:bg-muted/60'
              ">
              <input type="radio" formControlName="identificationType" [value]="idType.value" class="sr-only" />
              {{ idType.label }}
            </label>
          </div>

          <div>
            <label class="text-foreground mb-1.5 block text-sm font-medium">
              {{ 'signup.identification.idNumber' | translate }}
            </label>
            <input type="text" formControlName="passportNumber" placeholder="Enter your ID number" class="input" />
          </div>

          <div>
            <label class="text-foreground mb-1.5 block text-sm font-medium">
              {{ 'signup.identification.expiryDate' | translate }}
            </label>
            <input type="date" formControlName="passportExpiryDate" class="input" />
          </div>

          <div>
            <label class="text-foreground mb-1.5 block text-sm font-medium">
              {{ 'signup.identification.nationality' | translate }}
            </label>
            <input type="text" formControlName="nationality" placeholder="e.g. American" class="input" />
          </div>

          <div class="grid grid-cols-3 gap-2">
            <label
              *ngFor="let gender of genders"
              class="cursor-pointer rounded-lg border px-3 py-2 text-center text-sm transition-all duration-150"
              [ngClass]="
                signUpForm.get('gender')?.value === gender.value
                  ? 'bg-primary text-primary-foreground border-primary shadow'
                  : 'bg-muted text-muted-foreground border-border hover:bg-muted/60'
              ">
              <input type="radio" formControlName="gender" [value]="gender.value" class="sr-only" />
              {{ gender.label }}
            </label>
          </div>
        </div>

        <!-- Step 3: Final Step -->
        <div *ngIf="currentStep === 2" class="animate-fade-in space-y-4 sm:space-y-5">
          <div class="mb-4 text-center sm:mb-6">
            <h2 class="text-primary text-xl font-bold sm:text-2xl">{{ 'signup.final.heading' | translate }}</h2>
            <p class="text-muted-foreground mt-1 text-sm">{{ 'signup.final.subheading' | translate }}</p>
          </div>
          <div class="upload-box border border-dashed border-primary/40 rounded-xl p-6 text-center bg-muted/30 shadow-sm">
            <div class="flex justify-center mb-3">
              <svg-icon src="assets/icons/heroicons/outline/document-text.svg" class="w-8 h-8 text-primary"></svg-icon>
            </div>
            
            <p class="text-sm font-medium text-primary mb-1">
              {{ 'signup.final.uploadTitle' | translate }}
            </p>
            
            <p class="text-xs text-muted-foreground mb-4">
              {{ 'signup.final.uploadNote' | translate }}
            </p>
            
            <label class="inline-block cursor-pointer bg-primary text-primary-foreground px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary/90 transition">
              {{ 'signup.final.chooseFile' | translate }}
              <input type="file" (change)="onFileChange($event)" class="hidden" />
            </label>
            
            <div *ngIf="uploadedFileName" class="mt-4 text-sm text-foreground">
              <span class="font-medium">Selected:</span> {{ uploadedFileName }}
            </div>
          </div>
          

          <div class="mt-4 flex items-start gap-3 sm:mt-6">
            <input type="checkbox" formControlName="acceptTerms" id="acceptTerms" class="checkbox" />
            <label for="acceptTerms" class="text-muted-foreground text-sm leading-relaxed">
              {{ 'signup.final.termsText' | translate }}
              <a href="#" class="text-primary hover:underline">{{ 'signup.final.termsLink' | translate }}</a> &amp;
              <a href="#" class="text-primary hover:underline">{{ 'signup.final.privacyLink' | translate }}</a>
            </label>
          </div>

          <div class="summary-box">
            <h3 class="text-foreground text-sm font-medium sm:text-base">
              {{ 'signup.final.summaryTitle' | translate }}
            </h3>
            <div class="flex justify-between">
              <span>{{ 'signup.final.summary.name' | translate }}</span>
              <span>{{ signUpForm.get('fullName')?.value || ('signup.generic.notProvided' | translate) }}</span>
            </div>
            <div class="flex justify-between">
              <span>{{ 'signup.final.summary.email' | translate }}</span>
              <span>{{ signUpForm.get('email')?.value || ('signup.generic.notProvided' | translate) }}</span>
            </div>
            <div class="flex justify-between">
              <span>{{ 'signup.final.summary.idType' | translate }}</span>
              <span>{{
                signUpForm.get('identificationType')?.value || ('signup.generic.notProvided' | translate)
              }}</span>
            </div>
          </div>
        </div>

        <!-- Navigation -->
        <!-- Navigation -->
        <div class="mt-6 flex justify-between gap-3 sm:mt-8">
          <button
            type="button"
            *ngIf="currentStep > 0"
            (click)="previousStep()"
            class="btn-secondary bg-muted text-muted-foreground hover:bg-muted/70 rounded-lg px-4 py-2 font-medium transition">
            {{ 'signup.navigation.previous' | translate }}
          </button>

          <div *ngIf="currentStep === 0" class="flex-1"></div>

          <button
            type="button"
            *ngIf="currentStep < steps.length - 1"
            (click)="nextStep()"
            [disabled]="!isCurrentStepValid()"
            class="btn-primary bg-primary text-primary-foreground hover:bg-primary/90 rounded-lg px-4 py-2 font-medium transition disabled:opacity-50">
            {{ 'signup.navigation.next' | translate }}
          </button>

          <button
            type="submit"
            *ngIf="currentStep === steps.length - 1"
            [disabled]="signUpForm.invalid"
            class="btn-primary bg-primary text-primary-foreground hover:bg-primary/90 rounded-lg px-4 py-2 font-medium transition disabled:opacity-50">
            {{ 'signup.navigation.submit' | translate }}
          </button>
        </div>
      </form>

      <!-- Sign In Link -->
      <div class="text-muted-foreground mt-4 text-center text-sm sm:mt-6">
        {{ 'signup.navigation.alreadyHaveAccount' | translate }}
        <a (click)="onNavigateToSignIn()" class="text-primary touch-target font-medium hover:underline">
          {{ 'signup.navigation.signin' | translate }}
        </a>
      </div>
    </div>
  </form>
</div>
